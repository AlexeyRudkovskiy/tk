## Установка

### Зависимости

* PHP >= 7.0.0
* MySQL >= 5.7.0
* OpenSSL PHP Extension
* PDO PHP Extension
* Mbstring PHP Extension
* Tokenizer PHP Extension
* XML PHP Extension
* Imagick PHP Extension

### Права доступа

После клонирования или загрузки на сервер необходимо восстановить правильные права доступа.
Папки ```./storage``` и ```./bootstrap/cache``` должны быть записуемыми для пользователя, от 
которого запущен сервер.

### Команды

```bash
composer install
php artisan key:generate
php artisan storage:link
```

### Пути

На веб сервере в качестве корневого пути необходимо указывать путь к папке ``public``.
Папке ``storage`` должна быть доступна на запись.

## Настройка

Указать данные базы данных в файле .env:
```ini
DB_CONNECTION=mysql
DB_HOST=
DB_PORT=
DB_DATABASE=
DB_USERNAME=
DB_PASSWORD=
```

Выполнить команду для создания администратора:
```bash
php artisan admin:create
```

### Внешний вид

Для постройки необходимо выполнить комманду:
```bash
npm install
```

Далее, в зависимости от среды выполнения (development или production) выполнить комманду:
```bash
npm build
npm build:prod
```

Первая комманда выполнит построение для development среды. Вторая - для production.
Для выполенния этих команд требуется утилита npx, которая поставляется вместе с nodejs
последних версий.

Результат сборки будет в папке ``public``. Стили находятся в файле
``public/frontend.style.css``. Скрипты - ``public/index.bundle.js``

Исходные коды находятся в папках ``resources/assets/scss`` и ``resources/assets/typescript``
соответственно.

## Наполнение

Наполнение возможно двумя путями:
* Повторное копирование информации
* Восстановление копии

### Повторное копирование информации

Этот этап необходимо выполнить до того, как существующий сайт перестанет работать по необходимому домену,
т.к. в процессе этого шага будут происходить обращения к страницам текущего сайта.

Для наполнения  сайта существующими новостями и страницами необходимо загрузить
дамп в необходимую базу данных, загрузить файлы новостей в специальную папку.

Файлы новостей необходимо загрузить в папку ``./storage/app/transfer``. После этого
необходимо выполнить две команды:

```bash
php artisan app:transfer
php artisan app:transfer:files
```

Первая команда загрузит новости из файлов в базу данных. Вторая команда копирует файлы с
существующего сайта в необходимую папку нового.

### Восстановление копии

Для восстановления копии необходимо импортировать дамп базы данных и распаковать файлы из архива
в папку ```./storage/app/public```.
Дополнительно необходимо задать всем папкам и файлам внутри папки ```./storage/app/public``` 
права 777.
